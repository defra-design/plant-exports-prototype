{% extends "layout.html" %}

{% block pageTitle %}
  [title] - Manage account - {{serviceName}} - GOV.UK
{% endblock %}

{% block beforeContent %}
{{super()}}
<div class="login-nav login-border">
  <ul class="login-nav__list">
    <li class="login-nav__list-item-new">Prototype user</li>
    <li class="login-nav__list-item-new"><a href="../account" class="govuk-link login-nav__link-new govuk-link--no-visited-state profile">Manage account</a></li>
    <li class="login-nav__list-item-new"><a href="#" class="govuk-link login-nav__link-new govuk-link--no-visited-state">Sign out</a></li>
  </ul>
</div>

<a href="javascript:history.back()" class="govuk-back-link">Back</a>
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  
  <div class="govuk-grid-column-two-thirds">

    <!-- <h1 class="govuk-heading-xl">Are you applying to PHEATS? {{data.dave}}</h1> -->

    {% if data.deleted != "false" %}
    <div class="govuk-notification-banner govuk-notification-banner--success" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
        <div class="govuk-notification-banner__header">
            <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
            Success
            </h2>
        </div>
        <div class="govuk-notification-banner__content">
            <h3 class="govuk-notification-banner__heading">
              Authorised person deleted
            </h3>
            <p class="govuk-body">{{data.deleted}} has been deleted.</p>
        </div>
    </div>
    {% endif %}

    <h1 class="govuk-heading-xl">
      Authorised people
    </h1>

    <p class="govuk-body">Here are all the people authorised to do PHEATS inspections.</p>

    <!-- <h2 class="govuk-heading-l">
      [authorised people added]
    </h2> -->

    {% set _apCount = data['apCount'] or 1 | int %}
    {% set _apCountDeleted = _apCount|int - 1 %}
    {% set _apCountNext = _apCount|int + 1 %}

    <dl class="govuk-summary-list govuk-!-margin-bottom-9">

      {% for i in range(0, _apCount) -%}

        <div class="govuk-summary-list__row">
            <dt class="govuk-summary-list__key">
              {% set _apName = 'apName' + loop.index %}
              {% set _apNameLabel = data[_apName] or 'Jane Doe' %}
              {{_apNameLabel}}
            </dt>
            <dd class="govuk-summary-list__value">
                <p class="govuk-body">
                  {% set _apPosition = 'apPosition' + loop.index %}
                  {% set _apEmail = 'apEmail' + loop.index %}
                  {{data[_apPosition] or 'Manager'}}<br>
                  {{data[_apEmail] or 'email@email.com'}}
                </p>
            </dd>
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link govuk-link--no-visited-state" href="#">
                Edit<span class="govuk-visually-hidden"> </span>
              </a>
            </dd>
            <!-- pheats-ap?deleted=false -->
            {% set _deleteLink = "pheats-aps-added?deleted=" + _apNameLabel + "&apCount=" + _apCountDeleted | int %}
            {% if _apCount | int == 1 %}
            {% set _deleteLink = "pheats-ap?deleted=" + _apNameLabel + "&apCount=" + _apCount | int %}
            {% endif %}
            <dd class="govuk-summary-list__actions">
              <a class="govuk-link govuk-link--no-visited-state" href="{{_deleteLink}}">
                  Delete<span class="govuk-visually-hidden"> </span>
              </a>
            </dd>
            <!-- pheats-ap?deleted=ap -->
        </div>
      {%- endfor %}

    </dl>


    

    <form method="post" novalidate>
      <div class="govuk-form-group ">
        <fieldset class="govuk-fieldset">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
            Add an authorised person?
          </legend>

          <p class="govuk-body">It may take several months for a new authorised person to get approved to do inspections.</p>
          
          <div class="govuk-radios" data-module="govuk-radios">
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="pheatsAddAP-1" name="pheatsAddAP" type="radio" value="Yes~pheats-ap?apCount={{_apCountNext | int}}">
              <label class="govuk-label govuk-radios__label" for="pheatsAddAP-1">
                Yes
              </label>
            </div>
            <div class="govuk-radios__item">
              <input class="govuk-radios__input" id="pheatsAddAP-2" name="pheatsAddAP" type="radio" value="No~pheats-site">
              <label class="govuk-label govuk-radios__label" for="pheatsAddAP-2">
                No
              </label>
            </div>

          </div>
        </fieldset>
      </div>

      <button class="govuk-button" data-module="govuk-button">
        Continue
      </button>

      {% set _pheatsReturnURL = 'pheats-aps-added' %}
      <p class="govuk-body govuk-!-margin-top-2"><a href="pheats-cancel?pheatsReturnURL={{_pheatsReturnURL}}" class="govuk-link govuk-link--no-visited-state">Cancel PHEATS application</a></p>

    </form>

  </div>
</div>
{% endblock %}
